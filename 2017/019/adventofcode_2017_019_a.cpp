#include <iostream>
#include <string>
#include <vector>

using namespace std;

class Point {
    public:
      short max_x;
      short max_y;
      short x = 0;
      short y = 0;
      void Nord() {
          x--;
      }
      void Est() {
          y++;
      }
      void Sud() {
          x++;
      }
      void Ouest() {
          y--;
      }
      Point(short x, short y) {
          max_x = x;
          max_y = y;
      }
};

int main() {
  clock_t begin = clock();
  /*vector<string> input = {"     |          ", 
                          "     |  +--+    ", 
                          "     A  |  C    ", 
                          " F---|----E|--+ ", 
                          "     |  |  |  D ", 
                          "     +B-+  +--+ ", 
                          "                "};*/
  vector<string> input = {" |                                                                                                                                                                                                       ",
                          " | +-----------------------------------------+         +-----------------------------------+           +-+ +-+     +---------------------------------------------------------+ +-+           +---+       ",
                          " | |                                         |         |                                   |           | | | |     |                                                         | | |           |   |       ",
                          " | |                                         |   +-----------------------------------------------------|-|-|-------|---------------------------------------------------------+ | |           |   |       ",
                          " | |                                         |   |     |                                   |           | | | |     |                                                           | |           |   |       ",
                          " | |                                         |   |     |                                   +---+       | +-|-----+ | +-----------+             +-+             +---------------|-|-----------+   |       ",
                          " | |                                         |   |     |                                       |       |   | |   | | |           |             | |             |               | |               |       ",
                          " | |                                         |   |     |                         +-------------|-------------------|-|-----------------------------------------+       +-------|-|---------+     |       ",
                          " | |                                         |   |     |                         |             |       |   | |   | | |           |             | |                     |       | |         |     |       ",
                          " | |                                         |   |     |                         +-------------|-------|-------------------------|-----------------------------------------+   | |         |     |       ",
                          " | |                                         |   |     |                                       |       |   | |   | | |           |             | |                     |   |   | |         |     |       ",
                          " | |                 +-----------------------|---------|-----------------------------------------------|---|-----|-|-|-----------|---------------------+   +-------+   |   |   | |   +-----|-+   |       ",
                          " | |                 |                       |   |     |                                       |       |   | |   | | |           |             | |     |   |       |   |   |   | |   |     | |   |       ",
                          " | |                 |                       |   |     |                       +-----------------------|---+ |   | | |           |             | |     |   |     +-|-------|---|-----+     | |   |       ",
                          " | |                 |                       |   |     |                       |               |       |     |   | | |           |             | |     |   |     | |   |   |   | |         | |   |       ",
                          " | |       +---------|-------------------------------------------------------------------------|-------------------|-|-----------|---------------|---------------|---------------|---------------|-----+ ",
                          " | |       |         |                       |   |     |                       |               |       |     |   | | |           |             | |     |   |     | |   |   |   | |         | |   |     | ",
                          " | |       |         |                       |   |     |                       |               |       |     |   | | |           |             | |     |   |     | |   |   |   | |         | |   |     | ",
                          " | |       |         |                       |   |     |                       |               |       |     |   | | |           |             | |     |   |     | |   |   |   | |         | |   |     | ",
                          " | |       |         |                 +-----|---------------------------+     |               | +-----|---------|-|-|---------+ |             | | +---|---|---------------+   | |       +-|-----|---+ | ",
                          " | |       |         |                 |     |   |     |                 |     |               | |     |     |   | | |         | |             | | |   |   |     | |   |       | |       | | |   |   | | ",
                          " | |       |         +-----------------|---------|-----------------------------------------------|-----|-----------|-------------|-------------|---+   |   |     | |   |       | |       | | |   |   | | ",
                          " | |       |                           |     |   |     |                 |     |               | |     |     |   | | |         | |             | |     |   |     | |   |       | |       | | |   |   | | ",
                          " | |       |                           |     |   |     |                 +-----|---------------|-|-----|---------|---+         | |             +-----------|-----------|-------------+   | | |   |   | | ",
                          " | |       |                           |     |   |     |                       |               | |     |     |   | |           | |               |     |   |     | |   |       | |   |   | | |   |   | O ",
                          " | |       |                           |     |   |     |                       |             +-|-------|-----------|-----------|-|-------+       |     |   |     | |   |       | |   |   | | |   |   | | ",
                          " | |       |                           |     |   |     |                       |             | | |     |     |   | |           | |       |       |     |   |     | |   |       | |   |   | | |   |   | | ",
                          " | |       |                           |     |   |     |                       |             | | |     |     |   | |           +-+       |       |     |   |     | |   |       | |   |   | | |   |   | | ",
                          " | |       |                           |     |   |     |                       |             | | |     |     |   | |                     |       |     |   |     | |   |       | |   |   | | |   |   | | ",
                          " | |       |                           |     |   |     |                       |             | | |     | +-------|-|---------------------|---+ +-----+ |   |     | |   |       | |   |   | | |   |   | | ",
                          " | |       |                           |     |   |     |                       |             | | |     | |   |   | |                     |   | | |   | |   |     | |   |       | |   |   | | |   |   | | ",
                          " | +---------+                         |     |   +-----|-----------------------|-------------|-|-------|-|---|-----|-+   +-+ +-+ +-------|-+ | | |   | |   |     | |   |       | |   |   | | |   |   | | ",
                          " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |       | |   |   | | |   |   | | ",
                          " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   +-----|-------|-|-|---|-+ | | ",
                          " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   |   | |   |   | | |   | | | | ",
                          " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   |   | |   |   | | |   | | | | ",
                          " |         | |                         |     |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   |   | |   |   | | |   | | | | ",
                          " |         | |                         +-----|---------------------------------------------------|-----|-----|---|-|K--------|---|-------|-----|-----|-------------|-------|---|-+   |   | | |   | | | | ",
                          " |         | |                               |         |                       |             | | |     | |   |   | | |   | | | | |       | | | | |   | |   |     | |   |   |   |     |   | | |   | | | | ",
                          " |         | |       +-----------------------|-----------------------------------------------|---|-----|-|-------|---+   | | | | |       | +-----------|---|-----|-|-----+ |   | +---|-+ | | |   | | | | ",
                          " |         | |       |                       |         |                       |             | | |     | |   |   | |     | | | | |       |   | | |   | |   |     | |   | | |   | |   | | | | |   | | | | ",
                          " |         | +-------|---------------------------------|-------------------------------------|---------|-|-------|-|-----------|-|-----+ | +---+ |   | |   |     | |   | | |   | |   | | | | |   | | | | ",
                          " |         |         |                       |         |                       |             | | |     | |   |   | |     | | | | |     | | | |   |   | |   |     | |   | | |   | |   | | | | |   | | | | ",
                          " |         |         |                       | +---------------------------------------------------------|---|---|-------|---|-|-|---------|-|-----+ +-|-----------|---|---|---|-|-------|---------+ | | ",
                          " |         |         |                       | |       |                       |             | | |     | |   |   | |     | | | | |     | | | |   | |   |   |     | |   | | |   | |   | | | | |   |   | | ",
                          " |         |         |                 +-+   | |       | +---------------------------------------|-----|-|---|-----------|---|---|-----|-|-|-|---|-+   |   |     | |   | | |   | |   | | | | |   |   | | ",
                          " |         |         |                 | |   | |       | |                     |             | | |     | |   |   | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | | | | |   |   | | ",
                          " |         |         |         +---------|---|-|-------|---------+             |             | | |     | |   | +---|---------|-|---------|---|-------------------------|-|-----|-|---|-|-+ | |   |   | | ",
                          " |         |         |         |       | |   | |       | |       |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ",
                          " |         |     +-----------------------------|-----------+     |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ",
                          " |         |     |   |         |       | |   | |       | | |     |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ",
                          " |     +-----------+ | +-+     |       | |   | |       | | |     |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ",
                          " |     |   |     | | | | |     |       | |   | |       | | |     |             |             | | |     | |   | | | |     | | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ",
                          " |     |   |     | | | | |     |       | |   | |       | | |     |             +-------------+ +-|-----------|-|---------+ | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ",
                          " |     |   |     | | | | |     |       | |   | |       | | |     |                               |     | |   | | | |       | | | |     | | | |   |     |   |     | |   | | |   | |   | |   | |   |   | | ",
                          " |     |   |     | | | | |     |       | |   | |       | | |     |                               |     | |   | | | |       | | | |     | +-----+ |     |   |     | |   | | |   | |   | |   | |   |   | | ",
                          " |     |   |     | | | | |     |       | |   | |       | | |     |                               |     | |   | | | |       | | | |     |   | | | |     |   |     | |   | | |   | |   | |   | |   |   | | ",
                          " |     |   |     | +-----|-------------|-|---|---------------------------------------+           |     | |   | | | |       | | | | +---|-----|-------------|-----|-----|-|-------|---------|-+   | +-|-+ ",
                          " |     |   |     |   | | |     |       | |   | |       | | |     |                   |           |     | |   | | | |       | | | | |   |   | | | |     |   |     | |   | | |   | |   | |   |     | | |   ",
                          " |     |   |     | +-|---|-------------|-----|-|-----------|-------------------------|-----------|-------|---------|-----------|---|---------|-|-------|-----------|-------|---|-------------+   | | |   ",
                          " |     |   |     | | | | |     |       | |   | |       | | |     |                   |           |     | |   | | | |       | | | | |   |   | | | |     |   |     | |   | | |   | |   | |   | |   | | |   ",
                          " |     |   |     | | | | |     |       | |   | |       | | |     |                   |           |     | |   | | | |   +-----|---|-|-------------|-----|---|-----|---+ | | +---|-|---|-----------|---|-+ ",
                          " |     |   |     | | | | |     |       | |   | |       | | |     |                   |           |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     | |   | |   | |   | | | | ",
                          " | +-----------------|-|-|-------------|-|---+ |       | | |     |           +-------|-------+   |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     | |   | |   | |   | | | | ",
                          " | |   |   |     | | | | |     |       | |     |       | | |     |           |       |       |   |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     | |   | |   | |   | | | | ",
                          " | |   |   |     | | | | |     |       | |     |       | | |     |           |       |       |   |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     | +-----------------|-|-+ ",
                          " | |   |   |     | | | | W     |       | |     |       | | |     |           |       |       |   |     | |   | | | |   |   | | | | |   |   | | | |     |   |     | | | | |     |     | |   | |   | | |   ",
                          " | |   |   |     | | | | |     |       | |     |     +---|-------|-------------------|-+     |   |     | |   | | | |   |   | | | | |   | +-|-|-|-----------------|---|-+ +-----|---+ | |   | |   | | |   ",
                          " | |   |   |     | | | | |     |       | |     |     | | | |     |           |       | |     |   |     | |   | | | |   |   | | | | |   | | | | | |     |   |     | | |         |   | | |   | |   | | |   ",
                          " | |   |   |     | | | | |     |       | |     |     | | | |     |           |       | |     |   |     | |   | | +-----|-----|-----|-----|-|-|---+     |   |     | | | +-+     |   | | |   | |   | | |   ",
                          " | |   |   |     | | | | |     |       | |     |     | | | |     |           |       | |     |   |     | |   | |   |   |   | | | | |   | | | | |       |   |     | | | | |     |   | | |   | |   | | |   ",
                          " | |   |   |     | | | | |     |     +-|-|-----|-------|-|-----------------------------|---+ |   |     | |   | |   +---|---|-|-|-|-----|-|-|-|-|-----------|--R--|---+ | |     |   +-|-+   | |   | | |   ",
                          " | |   |   |     | | | | |     |     | | |     |     | | | |     |           |       | |   | |   |     | |   | |       |   | | | | |   | | | | |       |   |     | |   | |     |     |     | |   | | |   ",
                          " | |   +---------|-------------|---------------|-----|-|-|-------------------+       | |   | |   |     | |   | |       |   | | | | |   | | | | |       |   |     | |   | |     |   +-+ +---|---+ | | |   ",
                          " | |       |     | | | | |     |     | | |     |     | | | |     |                   | |   | |   |     | |   | |       |   | | | | |   | | | | |       |   |     | |   | |     |   |   |   | | | | | |   ",
                          " | |       |     | | | | |     |     | | |     |     | | | |     |                   +-|---------------|-|---|-|-------------|-|-|-----|-|-|-----------|---------+ |   | |     |   |   |   | | | | | |   ",
                          " | |       |     | | | | |     |     | | |     |     | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |       |   |       |   | |     |   |   |   | | | | | |   ",
                          " | |       |     | | | | |     |     | | +-----------------------|---------------------|---|-----|-----|-------|-------|---|-----|-----|---|-|---------|-+ |       |   | |     +---+   |   | | | | | |   ",
                          " | |       |     | | | | |     |     | |       |     | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |       | | |       |   | |             |   | | | | | |   ",
                          " | | +-----|---------|-----------------|-------|-----|-|---|-----|---------------------------|---|-------------|-----------------|-|-----------|-----+ | | |       |   | |             |   | | | | | |   ",
                          " | | |     |     | | | | |     |     | |       |     | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |     | | | |       |   | |             |   | | | | | |   ",
                          " | | +---+ |     | | | | |     |     | +-----------+ | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |     | +-|-|-----------|-|-------+ +-------|-|-----|---+ ",
                          " | |     | |     | | | | |     |     |         |   | | | | |     |                     |   | |   |     | |   | |       |   | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ",
                          " +-|-------------|-|-|-|-------------|-------------|-------------|-------------------------|-----------|-----------------+ | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ",
                          "   |     | |     | | | | |     |     |         |   | | | | |     |                     |   | |   |     | |   | |       | | | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ",
                          " +---+   | |     | | | | |     |     |         |   | | | | |     |                     +---------------|-+   | |       | | | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ",
                          " | | |   | |     | | | | |     |     |         |   | | | | |     |                         | |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       | |   |   | | | | | | | ",
                          " | | |   | |   +---|-----|-----|-----|-+       |   | | | | |     |                     +-----|---|-----|-----|-------------|-----------|-|---|-------------|-------|-------------|-+   |   | | | | | | | ",
                          " | | |   | |   | | | | | |     |     | |       |   | | | | |     |                     |   | |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     |   | | | | | | | ",
                          " | | |   | |   | | | | | |   +-+     | |       |   | | | | |     |                   +-+   | |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     |   | | | | | | | ",
                          " | | |   | |   | | | | | |   |       | |       |   | | | | |     |                   |     | |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     |   | | | | | | | ",
                          " +---|-----------|-|-|-|-----|-------|---------|---|-|-----|-------------------------|-----+ |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     | +-+ | | | | | | ",
                          "   | |   | |   | | | | | |   |       | |       |   | | | | |     |                   |       |   |     |     | |       | | | | | | |   | | | | |     |   | |       |   | |       |     | |   | | | | | | ",
                          "   | |   | |   | | | | +-----+       | |       |   +-|-----|-----|-------------------|-------|---------|-----|-------------|-------|-----|-----|-----|---|-------------+ |       |     | |   | | | | | | ",
                          "   | |   | |   | | | |   |           | |       |     | | | |     |                   |       |   |     |     | |       | | | | | | |   | | | | |     |   | |       E     |       |     | |   | | | | | | ",
                          "   | |   | |   | | | |   |           +-|-------------------|-------------------------------------|-----------|-|-------|---|-|-|-------|-----|-|-----|---|---------|-----------+ |     | |   | | | | | | ",
                          "   | |   | |   | | | |   |             |       |     | | | |     |                   |       |   |     |     | |       | | | | | | |   | | | | |     |   | |       |     |     | |     | |   | | | | | | ",
                          " +---------|---|-----------------------|-------------------|---------------------+   |       | +-|-----+     | |       | | | | | | |   | | | | |     |   | +-------|-----|-------|---+ | | +-----|-|---+ ",
                          " | | |   | |   | | | |   |             |       |     | | | |     |               |   |       | | |           | |       | | | | | | |   | | | | |     |   |         |     |     | |   | | | | | | | | |   ",
                          " | | +---|-----+ | | |   |             |       |     | | | |     |               |   |       | | |           | |       | | | | | +-----------|-|-----|-------------+     |     | |   | | | | | | | | |   ",
                          " | |     | |     | | |   |             |       |     | | | |     |               |   |       | | |           | |       | | | | |   |   | | | | |     |   |               |     | |   | | | | | | | | |   ",
                          " +-----+ | |     | | |   |             |       |     | | | |     |               |   |       | | |   +---------|-------|---|-|-----|---|-----|-|---------|-----------------------|-----|-|-|---|-|---|-+ ",
                          "   |   | | |     | | |   |             |       |     | | | |     |               |   |       | | |   |       | |       | | | | |   |   | | | | |     |   |               |     | |   | | | | | | | | | | ",
                          "   |   +-|-----------|---|---------------+     |     | | | |     |               |   |       | | |   |       | |       | | | | |   |   | | | | |     |   |               |     | |   | | | | | | | | | | ",
                          "   |     | |     | | |   |             | |     |     | | | |     |               |   |       | | |   |       | |       | | | | |   |   | | | | |     |   |               |     | |   | | | | | | | | | | ",
                          " +---------------|-------|---------------|-+   |     | | | |   +-----------------------------|---|-+ |       | |       | | | | |   |   | | | | |     |   |               +-----|-|-+ | | | | | | | | | | ",
                          " | |     | |     | | |   |             | | |   |     | | | |   | |               |   |       | | | | |       | |       | | | | |   |   | | | | |     |   |                     | | | | | | | | | | | | | ",
                          " | |     | +-----|-------|---------------------|-------|---------|---------------------------|-|-----|-------|-----------|-+ +-----|---|---|---------|---|-+                   | | | | | | | | | | | | | ",
                          " | |     |       | | |   |             | | |   |     | | | |   | |               |   |       | | | | |       | |       | |     |   |   | | | | |     |   | |                   | | | | | | | | | | | | | ",
                          " | |     |       | | |   |             | | |   |     | | | +---------------------------------|-|-|-|-|---------|-------|-|-------------|-------|-----|---|---------------------------|---|-+ | | | | | | ",
                          " | |     |       | | |   |             | | |   |     | | |     | |               |   |       | | | | |       | |       | |     |   |   | | | | |     |   | |                   | | | | | |   | | | | | | ",
                          " +---+   |       | | |   |             | | |   |     | | |     | |               |   |   +---|-|-|-----------------------------|-------|---|-|-|-----|---|---------+           | | | | | |   | | | | | | ",
                          "   | |   |       | | |   |             | | |   |     | | |     | |               |   |   |   | | | | |       | |       | |     |   |   | | | | |     |   | |       |           | | | | | |   | | | | | | ",
                          "   | |   | +-------|-------------------|-|-|---------------------|---------------------+ |   | | | +-|-------|-------+ | |     |   |   | | | | |     |   | |       |           | | | | | |   | | | | | | ",
                          "   | |   | |     | | |   |             | | |   |     | | |     | |               |   | | |   | | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | | | | | | ",
                          "   +-------|-------|-----|-------------|---|---|-----|-----------|---------------|-----------+ | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | | +-+ | | ",
                          "     |   | |     | | |   |             | | |   |     | | |     | |               |   | | |     | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | |     | | ",
                          "     |   | |     | | |   |             | | |   |     | | |     | |               |   | | |     | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | |     | | ",
                          "     |   | |     | | |   |             | | |   |     | | |     | |               |   | | |     | |   |       | |     | | |     |   |   | | | | |     |   | |       |           | | | | | |   | |     | | ",
                          " +---|-----|-----|---------------------|-|-------------|-------|-----------------|---|-|-|-------|-----------------------|-----|---|---+ | | | |     |   | |       |           | | | | | |   | |     | | ",
                          " |   |   | |     | | |   |             | | |   |     | | |     | |               |   | | |     | |   |       | |     | | |     |   |     | | | |     |   | |       |           | | | | | |   | |     | | ",
                          " |   |   | |     | | |   |             | | |   |     | +-|-------|---------------|-----|---+ +---|---|-------|-------|---|-----|---|-----|-+ | |     |   | |       |           | | | | | |   | |     | | ",
                          " |   |   | |     | | |   |             | | |   |     |   |     | |               |   | | | | | | |   |       | |     | | |     |   |     |   | |     |   | |       |           | | | | | |   | |     | | ",
                          " |   |   | |   +-----|-------------------|-|-------+ |   |     | |   +---------------|---|-|-|-|-----|-------|-------|---|-----|---|---------|-------------|-------------+   +-----|---|-|-+ | |     | | ",
                          " |   |   | |   | | | |   |             | | |   |   | |   |     | |   |           |   | | | | | | |   |       | |     | | |     |   |     |   | |     |   | |       |     |   | | | | | | | | | |     | | ",
                          " |   |   | |   | | | |   +-----------+ +---|-------|-+   |     | |   |           +---|-|-----|---------------|-------|---|---------|-----------------|---+ |     +-|-+   |   | | | | | | | | | |     | | ",
                          " |   |   | |   | | | |               |   | |   |   |     |     | |   |               | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |   | | | | | | | | | |     | | ",
                          " |   |   | |   | | | |               |   | |   |   | +---|-----------|-----------+   | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |   +-|---|-----+ | | |     | | ",
                          " |   |   | |   | | | |               |   | |   |   | |   |     | |   |           |   | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |     | | | | |   | | |     | | ",
                          " |   |   | |   | | | |               +---|-|---|---------|-----|-----------------+   | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |     | | | | |   | | |     | | ",
                          " |   |   | |   | | | |                   | |   |   | |   |     | |   |               | | | | | | |   |       | |     | | |     |   |     |   | |     |     |     | | |   |     | | | | |   | | |     | | ",
                          " | +-|-+ | |   | | | |                   | +-------------------|-----------------------|-----|-|-|-------------|---+ | | | +---|---------------|-----------|-----|-------------|-----|-+   | | |     | | ",
                          " | | | | | |   | | | |                   |     |   | |   |     | |   |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ",
                          " | | | | | |   | | | |                   +-----|---------------|-+   |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ",
                          " | | | | | |   | | | |                         |   | |   |     |     |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ",
                          " | | | | | |   | | | |                         |   | |   |     |     |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ",
                          " | | | | | |   | | | |                         |   | |   |     |     |               | | | | | | |   |       | |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | |     | | |     | | ",
                          " | | | | | |   | | | |                         |   | |   +-----|---------------------------|-|-|-----|-------+ |   | | | | |   |   |     |   | |     |     |     | | |   |     | | | +-+   | | |     | | ",
                          " | | | | | |   | | | |                         |   | |         |     |               | | | | | | |   |         |   | | | | |   |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ",
                          " | | | | | |   | | | |                         |   | |         |     |               | | | | | | | +-|-------------|-|-----+   |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ",
                          " | | | | | |   | | | |                         |   | |         |     |               | | | | | | | | |         |   | | | |     |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ",
                          " | | | | | |   | | | |                         |   | |         |     |               | | | | | | | | |         |   | | | |     |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ",
                          " | | | | | |   | | | |                         |   | |         |     |               | | | | | | | | |         |   | | | |     |   |     |   | |     |     |     | | |   |     | | |   |   | | |     | | ",
                          " | | | | | |   | | | |                         |   | +---------|-----|---------------|-|-|-------|-----------------+ | | |     |   |     |   | |     |     |     | | +---|---+ | | | B +---|-|-|-+   | | ",
                          " | | | | | |   | | | |                         |   |           |     |               | | | | | | | | |         |     | | |     |   |     |   | |     |     |     | |     |   | | | | |     | | | |   | | ",
                          " | | | | | |   | | | |                         |   |           |     |               | | | | | | | | |         |     | | |     |   | +---+   | |     |     |     | |     |   | | | | +-+   | | | |   | | ",
                          " | | | | | |   | | | |                         |   |           |     |               | | | | | | | | |         |     | | |     |   | |       | |     |     |     | |     |   | | | |   |   | | | |   | | ",
                          " | | | | | |   +-|-|-------------+             |   |           |     |               +-+ | +---|-|---|-------------+ | | |     |   | |       | |     |     |     | | +-------|-----|---|-+ | | | |   | | ",
                          " | | | | | |     | | |           |             |   |           |     |                   |   | | | | |         |   | | | |     |   | |       | |     |     |     | | |   |   | | | |   | | | | | |   | | ",
                          " | | | | | |     | | |           |             |   |   +-------+     |                   |   | | | | |       +-|---|---|-|-----------|---------------|---+ | +-------|-----------|-----|-|-------|-+ | | ",
                          " | | | | | |     | | |           |             |   |   |             |                   |   | | | | |       | |   | | | |     |   | |       | |     |   | | |   | | |   |   | | | |   | | | | | | | | | ",
                          " | | | | | |     | | |           |             |   |   |             |                   |   | | +-|-|-------|-|---|---|-|---------|-+       | |     |   +-|---+ | +-+   |   | | | +---+ +-+ | | | | | | ",
                          " | | | | | |     | | |           |             |   |   |             |                   |   | |   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |           | | | | | | ",
                          " | | +-|---|-----+ | |           |             |   |   |             |                   |   | |   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |           | | | | | | ",
                          " | |   | | |       | |           |             |   |   |             |                   |   | |   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |           | | | | | | ",
                          " | |   | | |       | |           +---------+   |   |   |             |           +---------------------------|-----|-|---|-----|---|---------|-|-------------------------|-----|---------+   | | | | | | ",
                          " | |   | | |       | |                     |   |   |   |             |           |       |   | |   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |       |   | | | | | | ",
                          " | |   | | |       | |                     |   |   |   +-------------+   +-------|-----------|-+   | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |       |   | | | | | | ",
                          " | |   | | |       | |                     |   |   |                     |       |       |   |     | |       | |   | | | |     |   |         | |     |     | | | |       |   | | |       |   | | | | | | ",
                          " +-+   | +-|-+     | +---+                 |   |   |                     |       |       |   |     | |       | +---|---+ |     |   |         | |     |   +-+ | +-|-------|---|-------------------+ | +-+ ",
                          "       |   | |     |     |                 |   |   |                     |       |       |   |     | |       |     | |   |     |   |         | |     |   |   |   |       |   | | |       |   | |   |     ",
                          "       |   | |     +---+ +-------------------------|---------------------|-------------------------|-|-------|-----|-----+     |   |         | |     |   |   |   |       |   | | |       |   | |   |     ",
                          "       |   | |         |                   |   |   |                     |       |       |   |     | |       |     | |         |   |         | |     |   |   |   |       |   | | |       |   | |   |     ",
                          "       |   +-----------------------+       | +-+   |               +-+   |       |       +---|-------|-------|-------|---------|---|---------|-|-----|-+ |   |   |       |   | | |       |   | |   |     ",
                          "       |     |         |           |       | |     |               | |   |       |           |     | |       |     | |         |   |         | |     | | |   |   |       |   | | |       |   | |   |     ",
                          "   +---------+         |           +-------|-----------------------+ +-----------------------|-----|-----------+   | |         |   +-----------|-----------------------+ |   | | |       |   | |   +---+ ",
                          "   |   |               |                   | |     |                     |       |           |     | |       | |   | |         |             | |     | | |   |   |     | |   | | |       |   | |       | ",
                          "   |   |               |                   | +--N------------------------|-------------------|-----+ |       | +---|-|-+       |             | |     | | |   |   |     | |   | | |       |   | |       | ",
                          "   |   |               |                   |       |                     |       |           |       |       |     | | |       |             | |     | | |   |   |     | |   | | |       |   | |       | ",
                          "   |   |               |         +-----------------|---------------+ +-----------|-----------+ +-------------|-----|---+       +-------------|-|-----|---|---+   |     | |   | | |       |   | |       | ",
                          "   |   |               |         |         |       |               | |   |       |             |     |       |     | |                       | |     | | |       |     | |   | | |       |   | |       | ",
                          " +---------------------+         | +---------------+     +-----+   | |   |       |             |     |       |     | |                       | |     | | |       |     | |   | | |       |   | |       | ",
                          " | |   |                         | |       |             |     |   | |   |       |             |     |       |     | |                       | |     | | |       |     | |   | | |       |   | |       | ",
                          " | |   |                         | |       |             +-----|-----|---|-----------------------------------+     | |                       | |     | | |       |     | |   | | |       |   | |       | ",
                          " | |   |                         | |       |                   |   | |   |       |             |     |             | |                       | |     | | |       |     | |   | | |       |   | |       | ",
                          " +-|-----+                       +-+       |                   |   | +---|-------|-------------+     |             | |                       +-|--------L--------------+ |   | | |       |   | |       | ",
                          "   |   | |                                 |                   |   |     |       |                   |             | |                         |     | | |       |       |   | | |       |   | |       | ",
                          "   |   | |                                 |                   |   |     +---------------------------|---------------|-------------------------------+ | |       |       |   +---+       |   | |       | ",
                          "   |   | |                                 |                   |   |             |                   |             | |                         |       | |       |       |     |         |   | |       | ",
                          "   |   | |                                 |                   |   |             |                   +-----------------------------------------|-------|-----------------|---+ |         |   | | +---+ | ",
                          "   |   | |                                 |                   |   |             |                                 | |                         |       | |       |       |   | |         |   | | |   | | ",
                          "   |   | |                                 |                   |   |             |                                 | |                         |       | |       |       |   | |         |   | | |   | | ",
                          "   |   | |                                 |                   |   |             |                                 | |                         |       | |       |       |   | |         |   | | |   | | ",
                          "   |   | +---------------------------------|-----------------------|-------------------------------------------------+                         |       | |       |       |   | |         +-----|-----+ | ",
                          "   |   |                                   |                   |   |             |                                 |                           |       | |       |       |   | |             | | |     | ",
                          "   |   |             +---------------------------------------------+             |                                 |                           |       | |       |       |   +---------------+ +---+   | ",
                          "   |   |             |                     |                   |                 |                                 |                           |       | |       |       |     |                 | |   | ",
                          " +-+   |             |                     |                   |                 |                                 |                           |       | |       |     +-------------------------+ +---+ ",
                          " |     |             |                     |                   |                 |                                 |                           |       | |       |     | |     |                         ",
                          " |     +-------------------------------------------------------|-----------------|---------------------------------|---------------------------|-------|---------|-----+ |     |                         ",
                          " |                   |                     |                   |                 |                                 |                           |       | |       |       |     |                         ",
                          " |                   +-----------------------------------------+                 |         +-----------------------|---------------------------+       | |       |       |     |                         ",
                          " |                                         |                                     |         |                       |                                   | |       |       |     |                         ",
                          " |                                         |   +---------------------------------|-------------+                   |         +---------------------------+       |       |     |                         ",
                          " |                                         |   |                                 |         |   |                   |         |                         |         |       |     |                         ",
                          " +-----------------------------------------+   +---------------------------------|---------|-+ |                   |         +---------+               |         |       |     |                         ",
                          "                                                                                 |         | | |                   |                   |               |         |       |     |                         ",
                          " +--------Y----------------------------------------------------------------------|-----------|-|-------------------------------------------------------|---------|-------+     |                         ",
                          " |                                                                               |         | | |                   |                   |               |         |             |                         ",
                          " +-------------------------------------------------------------------------------+         +-+ +-------------------+                   +---------------+         +-------------+                         "};
  bool stop = false;
  string reponse = "";
  Point *p = new Point(input.size(),  input[0].size());
  short direction = 2;
  
  for(int i = 0; i < p->max_y; i++) if (input[0][i] != ' ') p->y = i;
  
  while(!stop) {
    switch(input[p->x][p->y]) {
      case '|': case '-': break; // on ignore ces deux cas
      case '+': // changement de direction
        if(direction == 1 || direction == 3) {
          if (p->x + 1 < p->max_x     && input[p->x + 1][p->y] != ' ') {
            direction = 2;
          } else {
            direction = 0;
          }
        } else if (direction == 0 || direction == 2) {
          if(p->y + 1 < p->max_y     && input[p->x][p->y + 1] != ' ') {
            direction = 1;
          } else {
            direction = 3;
          }
        } else {
          stop = true;
          break;
        }
      break;
      case ' ': stop = true;
      default: // une lettre de l'aphabet
        reponse += input[p->x][p->y];
      break;
    }
    switch(direction) {
      case 0: p->Nord(); break;
      case 1: p->Est(); break;
      case 2: p->Sud(); break;
      case 3: p->Ouest(); break;
    }
  }
  
  clock_t end = clock();
  printf("RÃ©sultat %s\n",reponse.data()); // RYLONKEWB
  printf("Duration = %f s\n",(double)(end - begin) / CLOCKS_PER_SEC);
}
